<!DOCTYPE html>
<html>
    <head>
        <title>MMLプラグイン サンプル</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <script src="../../snd.js"></script>
        <script src="../../plugins/snd.mml.js"></script>
        <script>
            MML_PLAYER = null;

            window.onload = function() {
                snd.init();

                MML_PLAYER = new snd.mml.MMLPlayer("TEST");
                MML_PLAYER.buffer = "";
            };

            button1Click = function() {
                if (MML_PLAYER != null) {
                    // 演奏を中断
                    MML_PLAYER.stopMML();

                    // 入力された楽譜に切り替え
                    var score = window.document.getElementById("score").value;
                    MML_PLAYER.buffer = score;

                    // 演奏開始
                    MML_PLAYER.startMML();
                }
            };
        </script>
    </head>
    <body>
        <h3>MML プラグイン(beta)</h3>
        <div>
            <input type="text" size="40" id="score" value="l8 cdefg>abc< r4 l16 [[cdef]2/g>abc]2 gedccdc"/>
            <input type="button" value="出力" onclick="button1Click();"/><br/>
        </div>
        <div>
            WebAudioAPIを使用した、JavaScriptによるMMLプラグインです。<br/>
            ドレミの書き方は下表の通りです。(大文字、小文字の区別はしません)<br/>
            <div>
            <h4>ドレミ表</h4>
            <table border="1">
                <tr><td>MMLコマンド</td><td>ドレミ表記</td></tr>
                <tr><td>A</td><td>ラ</td></tr>
                <tr><td>B</td><td>シ</td></tr>
                <tr><td>C</td><td>ド</td></tr>
                <tr><td>D</td><td>レ</td></tr>
                <tr><td>E</td><td>ミ</td></tr>
                <tr><td>F</td><td>ファ</td></tr>
                <tr><td>G</td><td>ソ</td></tr>
            </table>
            <br/>
            3オクターブのA(ラ)が基準音となっている関係で、「ド～ド」ではなく、「ラ～ラ」となっている点に注意してください。<br/>
            たとえば、「ドレミファソラシド」と記述する場合、「CDEFG>ABC」と記述します。<br/>
            <br/>
            各音符の直後に#,+,-を指定する事で、臨時記号を指定できます。<br/>
            数値を指定することで、音価を指定することも可能です。<br/>
            たとえば、「ラのシャープを16分音符で演奏」するコマンドは、「A#16」となります。<br/>
            <br/>
            音価を指定する値には制限がなく、「A10(10分音符のラ)」などの通常の楽譜では出てこない音符も指定可能です。<br/>
            また、臨時記号も複数指定することが可能です。（「A####」や「B##--##」も指定可能）<br/>
            <br/>
            ※音符コマンドは「A～G」 + 「臨時記号」＋「音価」の順番で記述してください。<br/>
            　たとえば、「A#16 (16分音符のラのシャープ)」は大丈夫ですが、「A16#」や「16A#」などはエラーとなり正しく演奏されません。
            </div>
            <h4>その他のコマンド</h4>
            <table border="1">
                <tr><td>MMLコマンド</td><td>意味</td></tr>
                <tr><td># または +</td><td>シャープ(半音上げ)</td></tr>
                <tr><td>-</td><td>フラット(半音下げ)</td></tr>
                <tr><td>T</td><td>テンポ指定(1分間に4分音符を何個演奏するか)</td></tr>
                <tr><td>O</td><td>オクターブ指定(デフォルト値はO3です。)</td></tr>
                <tr><td>&gt;</td><td>1オクターブ上げる</td></tr>
                <tr><td>&lt;</td><td>1オクターブ下げる</td></tr>
                <tr><td>L</td><td>デフォルトの音価を指定</td></tr>
                <tr><td>( )</td><td>和音</td></tr>
                <tr><td>[ / ]</td><td>ループ</td></tr>
            </table>
            <br/>
            ループは、「[」と「]」を使用します。<br/>
            ループの回数は「[CDE]3 ("CDE"を3回繰返し)」のように指定します。<br/>
            「]」の後にループ回数が指定されていない場合は無限ループになります。<br/>
            <br/>
            ループ終点からループ開始点に戻るときに、オクターブ等の設定がループ開始時点の状態にリセットされます。<br/>
            <br/>
            ループは入れ子にすることが可能です。<br/>
            そのため、「[CDECDECDEFG&gt;A]2」と「[[CDE]3FG&gt;A]2」は同じ結果が出力されます。(CDECDECDEFG&gt;A &lt; CDECDECDEFG&gt;A)<br/>
        </div>
    </body>
</html>
