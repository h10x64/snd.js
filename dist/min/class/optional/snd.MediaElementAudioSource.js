/**
 * snd.js - The Sound Library for JavaScript with WebAudioAPI - v.1.0 beta
 * 
 * The MIT License (MIT)
 * copyright (c) 2014 - 2015 N_H <h.10x64@gmail.com>
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 **/
!function(a,b){"function"==typeof define&&define.amd?define(["snd.AudioMaster","snd.util","snd.Source"],b):"object"==typeof exports||(a.snd=b(a.snd))}(this,function(a){return a.MediaElementAudioSource=function(b,c){a.Source.apply(this,arguments),this.id=b,this.listeners={onplay:[],onpause:[],onended:[],onabort:[],oncanplay:[],oncanplaythrough:[],ondurationchange:[],onemptied:[],onerror:[],onloadeddata:[],onloadedmetadata:[],onloadstart:[],onplaying:[],onprogress:[],onratechange:[],onseeked:[],onseeking:[],onstalled:[],onsuspend:[],ontimeupdate:[],onvolumechange:[],onwaiting:[]},Object.defineProperties(this,{element:{get:function(){return this._element},set:function(b){var c=this;this._source=a.AUDIO_CONTEXT.createMediaElementSource(b),this._source.connect(this._gain),this._element=b,null!=this._element.id&&(this._status.element=this._element.id),this._element.onplay=function(){c._status.status=a.status.STARTED;for(var b=0;b<c.listeners.onplay.length;b++)c.listeners.onplay[b](c)},this._element.onpause=function(){c._status.status=a.status.PAUSED;for(var b=0;b<c.listeners.onpause.length;b++)c.listeners.onpause[b](c)},this._element.onended=function(){c._status.status=a.status.PAUSED;for(var b=0;b<c.listeners.onended.length;b++)c.listeners.onended[b](c)},this._element.onabort=function(){for(var a=0;a<c.listeners.onabort.length;a++)c.listeners.onabort[a](c)},this._element.oncanplay=function(){c.status==a.status.NONE&&(c._status.status=a.status.READY);for(var b=0;b<c.listeners.oncanplay.length;b++)c.listeners.oncanplay[b](c)},this._element.oncanplaythrough=function(){for(var a=0;a<c.listeners.oncanplaythrough.length;a++)c.listeners.oncanplaythrough[a](c)},this._element.ondurationchange=function(){for(var a=0;a<c.listeners.ondurationchange.length;a++)c.listeners.ondurationchange[a](c)},this._element.onemptied=function(){for(var a=0;a<c.listeners.onemptied.length;a++)c.listeners.onemptied[a](c)},this._element.onerror=function(){for(var a=0;a<c.listeners.onerror.length;a++)c.listeners.onerror[a](c)},this._element.onloadeddata=function(){for(var a=0;a<c.listeners.onloadeddata.length;a++)c.listeners.onloadeddata[a](c)},this._element.onloadedmetadata=function(){for(var a=0;a<c.listeners.onloadedmetadata.length;a++)c.listeners.onloadedmetadata[a](c)},this._element.onloadedstart=function(){for(var a=0;a<c.listeners.onloadstart.length;a++)c.listeners.onloadstart[a](c)},this._element.onplaying=function(){for(var a=0;a<c.listeners.onplaying.length;a++)c.listeners.onplaying[a](c)},this._element.onprogress=function(){for(var a=0;a<c.listeners.onprogress.length;a++)c.listeners.onprogress[a](c)},this._element.onratechange=function(){for(var a=0;a<c.listeners.onratechange.length;a++)c.listeners.onratechange[a](c)},this._element.onseeked=function(){for(var a=0;a<c.listeners.onseeked.length;a++)c.listeners.onseeked[a](c)},this._element.onseeking=function(){for(var a=0;a<c.listeners.onseeking.length;a++)c.listeners.onseeking[a](c)},this._element.onstalled=function(){for(var a=0;a<c.listeners.onstalled.length;a++)c.listeners.onstalled[a](c)},this._element.onsuspend=function(){for(var a=0;a<c.listeners.onsuspend.length;a++)c.listeners.onsuspend[a](c)},this._element.ontimeupdate=function(){for(var a=0;a<c.listeners.ontimeupdate.length;a++)c.listeners.ontimeupdate[a](c)},this._element.onvolumechange=function(){for(var a=0;a<c.listeners.onvolumechange.length;a++)c.listeners.onvolumechange[a](c)},this._element.onwaiting=function(){for(var a=0;a<c.listeners.onwaiting.length;a++)c.listeners.onwaiting[a](c)}}},src:{get:function(){return this._element.src},set:function(a){this._element.src=a}}}),null!=c&&(this.element=c)},a.MediaElementAudioSource.prototype=Object.create(a.Source.prototype),a.MediaElementAudioSource.prototype.constructor=a.MediaElementAudioSource,a.MediaElementAudioSource.CLASS_NAME="snd.MediaElementAudioSource",a.MediaElementAudioSource.prototype.load=function(){this._element.load()},a.MediaElementAudioSource.prototype.start=function(){this._element.play()},a.MediaElementAudioSource.prototype.pause=function(){this._element.pause()},a.MediaElementAudioSource.prototype.stop=function(){this._element.pause(),this._element.currentTime=0},a.MediaElementAudioSource.prototype.setLoop=function(a){this._element.loop=a},a.MediaElementAudioSource.prototype.addOnPlayEventListener=function(a){this.listeners.onplay.push(a)},a.MediaElementAudioSource.prototype.removeOnPlayEventListener=function(a){for(var b=this.listeners.onplay,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnPauseEventListener=function(a){this.listeners.onPause.push(a)},a.MediaElementAudioSource.prototype.removeOnPauseEventListener=function(a){for(var b=this.listeners.onPause,c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}},a.MediaElementAudioSource.prototype.addOnEndedEventListener=function(a){this.listeners.onended.push(a)},a.MediaElementAudioSource.prototype.removeOnEndedEventListener=function(a){for(var b=this.listeners.onended,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnAbortEventListener=function(a){this.listeners.onabort.push(a)},a.MediaElementAudioSource.prototype.removeOnAbortEventListener=function(a){for(var b=this.listeners.onabort,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnCanPlayEventListener=function(a){this.listeners.oncanplay.push(a)},a.MediaElementAudioSource.prototype.removeOnCanPlayEventListener=function(a){for(var b=this.listeners.oncanplay,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnCanPlayThroughEventListener=function(a){this.listeners.oncanplaythrough.push(a)},a.MediaElementAudioSource.prototype.removeOnCanPlayThroughEventListener=function(a){for(var b=this.listeners.onplaythrough,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnDurationChangeEventListener=function(a){this.listeners.ondurationchange.push(a)},a.MediaElementAudioSource.prototype.removeOnCanPlayThroughEventListener=function(a){for(var b=this.listeners.ondurationchange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnEmptiedEventListener=function(a){this.listeners.onemptied.push(a)},a.MediaElementAudioSource.prototype.removeOnEmptiedEventListener=function(a){for(var b=this.listeners.onemptied,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnErrorEventListener=function(a){this.listeners.onerror.push(a)},a.MediaElementAudioSource.prototype.removeOnErrorEventListener=function(a){for(var b=this.listeners.onerror,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnLoadedDataEventListener=function(a){this.listeners.onloadeddata.push(a)},a.MediaElementAudioSource.prototype.removeOnLoadedDataEventListener=function(a){for(var b=this.listeners.onloadeddata,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnLoadedMetadataEventListener=function(a){this.listeners.onloadedmetadata.push(a)},a.MediaElementAudioSource.prototype.removeOnLoadedMetaDataEventListener=function(a){for(var b=this.listeners.onloadedmetadata,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnLoadStartEventListener=function(a){this.listeners.onloadstart.push(a)},a.MediaElementAudioSource.prototype.removeOnLoadStartEventListener=function(a){for(var b=this.listeners.onloadstart,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnPlayingEventListener=function(a){this.listeners.onPlaying.push(a)},a.MediaElementAudioSource.prototype.removeOnPlayingEventListener=function(a){for(var b=this.listeners.onPlaying,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnProgressEventListener=function(a){this.listeners.onprogress.push(a)},a.MediaElementAudioSource.prototype.removeOnProgressEventListener=function(a){for(var b=this.listeners.onprogress,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnRateChangeEventListener=function(a){this.listeners.onratechange.push(a)},a.MediaElementAudioSource.prototype.removeOnRateChangeEventListener=function(a){for(var b=this.listeners.onratechange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnSeekedEventListener=function(a){this.listeners.onseeked.push(a)},a.MediaElementAudioSource.prototype.removeOnSeekedEventListener=function(a){for(var b=this.listeners.onseeked,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnSeekingEventListener=function(a){this.listeners.onseeking.push(a)},a.MediaElementAudioSource.prototype.removeOnSeekingEventListener=function(a){for(var b=this.listeners.onseeking,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnStalledEventListener=function(a){this.listeners.onstalled.push(a)},a.MediaElementAudioSource.prototype.removeOnStalledEventListener=function(a){for(var b=this.listeners.onstalled,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnSuspendEventListener=function(a){this.listeners.onsuspend.push(a)},a.MediaElementAudioSource.prototype.removeOnSuspendEventListener=function(a){for(var b=this.listeners.onsuspend,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnTimeUpdateEventListener=function(a){this.listeners.ontimeupdate.push(a)},a.MediaElementAudioSource.prototype.removeOnTimeUpdateEventListener=function(a){for(var b=this.listeners.ontimeupdate,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnVolumeChangeEventListener=function(a){this.listeners.onvolumechange.push(a)},a.MediaElementAudioSource.prototype.removeOnVolumeChangeEventListener=function(a){for(var b=this.listeners.onvolumechange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.addOnWaitingEventListener=function(a){this.listeners.onwaiting.push(a)},a.MediaElementAudioSource.prototype.removeOnWaitingEventListener=function(a){for(var b=this.listeners.onwaiting,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},a.MediaElementAudioSource.prototype.getParamDescription=function(){var b=a.Source.prototype.getParamDescription.apply(this,arguments);return b.element={type:a.params.type.VALUE,"default":void 0,max:void 0,min:void 0},b.src={type:a.params.type.VALUE,"default":void 0,max:void 0,min:void 0},b},a.MediaElementAudioSource.prototype.createStatus=function(){return new a.MediaElementAudioSource.Status},a.MediaElementAudioSource.prototype.toJSON=function(){return this._status},a.MediaElementAudioSource.prototype.loadData=function(b){if(a.Source.prototype.loadData.apply(this,arguments),null!=b.element){var c=document.getElementById(b.element);null!=c&&(this.element=c)}},a.MediaElementAudioSource.loadJSON=function(b){var c=JSON.parse(b);if(c.className!=a.MediaElementAudioSource.CLASS_NAME)throw new a.Exception(c.id+" is not instance of 'snd.MediaElementAudioSource' class.");var d=new a.MediaElementAudioSource("");return d.loadData(c),d},a.MediaElementAudioSource.Status=function(){a.Source.Status.apply(this,arguments),this.className=a.MediaElementAudioSource.CLASS_NAME,this.status=a.status.NONE,this.element=""},a.MediaElementAudioSource.Status.prototype=Object.create(a.Source.Status.prototype),a.MediaElementAudioSource.Status.prototype.constructor=a.MediaElementAudioSource.Status,a.util.createMediaElementAudioSources=function(b,c,d){var e={};for(var f in b){var g,h=document.getElementById(f);null==h?(g=new Audio(f),d.appendChild(g)):g=h,null!=b[f]&&""!=b[f]&&(g.src=b[f]);var i=new a.MediaElementAudioSource(f,g);e[f]=i,c&&a.MASTER.connectAudioUnit(f,i)}return e},a});