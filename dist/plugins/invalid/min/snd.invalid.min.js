/**
 * snd.js - The Sound Library for JavaScript with WebAudioAPI - v.1.0 beta
 * 
 * The MIT License (MIT)
 * copyright (c) 2014 N_H <h.10x64@gmail.com>
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 **/
snd.invalid={varsion:0,isBeta:!0},snd.invalid.CLASS_DEF=[],snd.invalid.TAG_DEF={},jQuery&&jQuery.cssHooks&&(snd.invalid.doesCSSHooked={}),snd.PLUGIN_INIT.push(function(){snd.invalid.init=function(){var a=new MutationObserver(snd.invalid.observeCallback);a.observe(document.body,{childList:!0,subTree:!0});for(var b=Object.keys(snd.invalid.TAG_DEF),c=0;c<b.length;c++)for(var d=b[c],e=document.getElementsByTagName(d),f=0;f<e.length;f++){var g=e[f];snd.invalid.Element.setup(g,snd.invalid.TAG_DEF[d])}},snd.invalid.observeCallback=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.target;if("childList"==d.type){for(var c=0;c<d.addedNodes.length;c++){var f=d.addedNodes[c],g=f._invalid;if(!g){var h=f.tagName.toLowerCase();if(!(h in snd.invalid.TAG_DEF))continue;snd.invalid.Element.setup(f,snd.invalid.TAG_DEF[h])}}for(var c=0;c<d.removedNodes.length;c++){var f=d.removedNodes[c],g=f._invalid;if(g){var i=Object.keys(g._connected.out);if(i.length>0)for(var c=0;c<i.length;c++)g.disconnect(i[c]);if(i=Object.keys(g._connected["in"]),i.length>0)for(var c=0;c<i.length;c++){var j=document.querySelector(i[c]);j&&j._invalid._obj.disconnect(g._obj)}}}var k=snd.invalid.getMethod(e,"nodeCallback");"function"==typeof k&&k(d,b)}else{var g=e._invalid;if(g)if("attributes"==d.type){var l=snd.invalid.getMethod(e,"attributeCallback");"function"==typeof l&&l(d,b);var m=d.attributeName;"style"==m?g.changeStyle(d,b):g.changeAttribute(d,b)}else if("characterData"==d.type){var n=snd.invalid.getMethod(e,"characterDataCallback");"function"==typeof n&&n(d,b)}}}},snd.invalid.getMethodName=function(a){if(a._invalid){for(var b=a._invalid,c=b._settings,d=1;d<arguments.length;d++){var e=arguments[d];if(!c[e])return void 0;c=c[e]}return c}return void 0},snd.invalid.getMethod=function(a,b){if(a._invalid&&a._invalid._obj){var c=snd.invalid.getMethodName(a,b);return c?a._invalid._obj[c]:void 0}return void 0},snd.invalid.attributeCallback=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.target._invalid;if(e){var f=e._settings.attributeCallback;"function"==typeof e._obj[f]&&e._obj[f](a,b)}var g=[];if(e._lastAttributes)for(var c=0;c<d.target.attributes;c++)d.target.attributes[c].nodeValue!=e._lastAttributes[c].nodeValue&&g.push(d.target.attributes[c].nodeName);else for(var c=0;c<d.target.attributes;c++)g.push(d.target.attributes[c].nodeName);e.changeAttribute(g),e._lastAttributes=d.target.attributes}},snd.invalid.Element=function(a,b){var c=b["class"];this._parent=a,this._settings=b,this._observer=new MutationObserver(snd.invalid.observeCallback),this._connected={"in":{},out:{}},this._obj=new c(a.id),this._lastAttribute={},this._lastStyle=window.getComputedStyle(this._parent),this._observer.observe(a,{childlist:!0,attributes:!0})},snd.invalid.Element.prototype.changeAttribute=function(a){var b=a.attributeName;b&&this.setAttribute(b)},snd.invalid.Element.prototype.setAttribute=function(a){if("connectto"==a){var b,c=this._parent.getAttribute(a);b="string"==typeof c?c.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\s+/gm," ").split(" "):c,this.connectTo(b)}else{var d=snd.invalid.getMethod(this._parent,"attributes",a),e=this._parent.getAttribute(a);if("function"==typeof d)d(e);else{var f=snd.invalid.getMethodName(this._parent,"events",a);if(f){var g=this;this._obj[f]=function(){window.eval(g._parent.getAttribute(f))}}}}},snd.invalid.Element.prototype.changeStyle=function(){for(var a,b=this._lastStyle,c=window.getComputedStyle(this._parent),d={},e=0;e<b.length;e++){var f=b.item(e);b.getPropertyValue(f)!=c.getPropertyValue(f)&&(d[f]=c.getPropertyValue(f))}for(var e=0;e<c.length;e++){var f=c.item(e);d[f]||c.getPropertyValue(f)!=b.getPropertyValue(f)&&(d[f]=c.getPropertyValue(f))}a=Object.keys(d);for(var e=0;e<a.length;e++){var g=a[e],h=snd.invalid.getMethod(this._parent,"styles",g),i=d[g];this._obj[h]=i}this._lastStyle=c},snd.invalid.Element.prototype.connectTo=function(a){if(a){for(var b=Object.keys(this._connected.out),c=0;c<b.length;c++)a.indexOf(b[c])<0&&this.disconnect(b[c]);for(var c=0;c<a.length;c++)this._connected.out[a[c]]||this.connect(a[c])}Object.keys(this._connected.out).length<=0&&this.connect("MASTER")},snd.invalid.Element.prototype.connect=function(a){if("MASTER"==a.toUpperCase())return this._obj.connect(snd.MASTER),void(this._connected.out.MASTER=!0);if(a){var b=document.querySelector(a);b&&!this._connected.out["#"+b.id]&&(this._obj.connect(b._invalid._obj),this._connected.out["#"+b.id]=!0,b._invalid._connected["in"]["#"+this._parent.id]=!0)}},snd.invalid.Element.prototype.disconnect=function(a){if("MASTER"==a.toUpperCase())return this._obj.disconnect(snd.MASTER),void delete this._connected.out.MASTER;if(a){var b=document.querySelector(a);b&&this._connected.out["#"+b.id]&&(this._obj.disconnect(b._invalid._obj),delete this._connected.out["#"+b.id],delete b._invalid._connected["in"]["#"+this._parent.id])}},snd.invalid.Element.setup=function(a,b){var c=new snd.invalid.Element(a,b);a._invalid=c;for(var d=b.styles,e=b.methods,f=Object.keys(d),g=0;g<f.length;g++)!function(a,b){var c=a,e=d[f[c]];Object.defineProperty(b.style,f[c],{get:function(){return b._invalid._obj[e]},set:function(a){b._invalid._obj[e]=a}})}(g,a);f=Object.keys(e);for(var g=0;g<f.length;g++)!function(a,b){var c=a,d=e[f[c]];b[f[c]]=function(){b._invalid._obj[d].apply(b._invalid._obj,arguments)}}(g,a);if(jQuery&&jQuery.cssHooks&&(d=b.styles)){f=Object.keys(d);for(var h=0;h<f.length;h++){var i=f[h];!function(a){var b=a;jQuery.cssHooks[b]||(jQuery.cssHooks[b]={get:function(a){return a.style[b]},set:function(a,c){a.style[b]=c}})}(i)}}for(var j=!1,h=0;h<a.attributes;h++)a._invalid.setAttribute(a.attributes[h].name),"connectto"==a.attributes[h].name&&(j=!0);j||a._invalid.setAttribute("connectto")};for(var a=0;a<snd.invalid.CLASS_DEF.length;a++)snd.invalid.CLASS_DEF[a]()});