/* snd.js - The Sound Library for JavaScript with WebAudioAPI - v.0.1.0 */snd={VERSION:"62190",IS_BETA:!0},snd.BLOWSER=window.navigator.userAgent.toLowerCase(),snd.DOES_MP3_SUPPORTED=!1,-1!=snd.BLOWSER.indexOf("chrome")&&(snd.DOES_MP3_SUPPORTED=!0),snd.status={},snd.status.NONE="none",snd.status.READY="ready",snd.status.STARTED="started",snd.status.PAUSED="paused",snd.status.STOPPED="ended",snd.srctype={},snd.srctype.NONE="none",snd.srctype.AUDIO_BUFFER="AudioBuffer",snd.srctype.MEDIA_STREAM="MediaStream",snd.srctype.MEDIA_ELEMENT="MediaElement",snd.srctype.OSCILLATOR="Oscillator",snd.oscillatortype={},snd.oscillatortype.SINE="sine",snd.oscillatortype.SQUARE="SQUARE",snd.oscillatortype.SAWTOOTH="SAWTOOTH",snd.oscillatortype.TRIANGLE="TRIANGLE",snd.audioparam={},snd.audioparam.type={},snd.audioparam.type.SET="Set",snd.audioparam.type.LINER="Liner",snd.audioparam.type.EXPONENTIALLY="Exponentially",snd.vec3=function(a,b,c){this.x=a,this.y=b,this.z=c},snd.vec3.prototype.add=function(a){return new snd.vec3(this.x+a.x,this.y+a.y,this.z+a.z)},snd.vec3.prototype.mult=function(a){return new snd.vec3(a*this.x,a*this.y,a*this.z)},snd.vec3.prototype.sub=function(a){return this.add(a.mult(-1))},snd.vec3.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},snd.vec3.prototype.normalize=function(){return this.mult(1/this.length())},snd.vec3.prototype.toSphericalCoordinate=function(){var a=Math.atan2(this.z,this.x),b=Math.atan2(this.y,Math.sqrt(this.z*this.z+this.x*this.x)),c=this.length();return new snd.vec3(a,b,c)},snd.vec3.prototype.toOrthogonalCoordinate=function(){var a=this.z*Math.sin(this.y),b=this.z*Math.cos(this.y)*Math.cos(this.x),c=this.z*Math.cos(this.y)*Math.sin(this.x);return new snd.vec3(b,a,c)},snd.PosDir=function(){this.pos=new snd.vec3(0,0,0),this.dir=new snd.vec3(0,0,-1),this.up=new snd.vec3(0,1,0)},snd.PosDir.prototype.setPosition=function(a,b,c){this.pos.x=a,this.pos.y=b,this.pos.z=c},snd.PosDir.prototype.setDir=function(a,b,c){this.dir.x=a,this.dir.y=b,this.dir.z=c,this.dir.normalize()},snd.PosDir.prototype.setUp=function(a,b,c){this.up.x=a,this.up.y=b,this.up.z=c,this.up.normalize()},snd.PosDir.prototype.setOrientation=function(a,b,c,d,e,f){this.setDir(a,b,c),this.setUp(d,e,f)},snd.PosDir.prototype.setOrientationBySpherical=function(a,b){var c;if(null!=b){var d=b.toOrthogonalCoordinate();this.setTop(d.x,d.y,d.z);var e=a.sub(b);e.normalize(),c=e.toOrthogonalCoordinate()}else c=a.toOrthogonalCoordinate();this.setDir(c.x,c.y,c.z)},snd.PosDir.interpolation=function(a,b,c){var d={},e={px:{left:a.pos.x,right:b.pos.x},py:{left:a.pos.y,right:b.pos.y},pz:{left:a.pos.z,right:b.pos.z},ux:{left:a.up.x,right:b.up.x},uy:{left:a.up.y,right:b.up.y},uz:{left:a.up.z,right:b.up.z},dx:{left:a.dir.x,right:b.dir.x},dy:{left:a.dir.y,right:b.dir.y},dz:{left:a.dir.z,right:b.dir.z}};for(var f in e)d[f]=e[f].left+(e[f].right-e[f].left)*c;var g=new snd.PosDir;return g.setPos(d.px,d.py,d.pz),g.setUp(d.ux,d.uy,d.uz),g.setDir(d.dx,d.dy,d.dz),g},snd.Source=function(a){this.isSource=!0,this.gain=snd.AUDIO_CONTEXT.createGain(),this.id=a,this.type=snd.srctype.NONE,this.status=snd.status.NONE},snd.Source.prototype.start=function(){},snd.Source.prototype.stop=function(){},snd.Source.prototype.setGain=function(a){this.gain.gain.value=a},snd.Source.prototype.getGain=function(){return this.gain.gain.value},snd.Source.prototype.connect=function(a){this.gain.connect(a.isAudioUnit?a.getConnector():a)},snd.Source.prototype.disconnect=function(a){this.gain.disconnect(a.isAudioUnit?a.getConnector():a)},snd.BufferSource=function(){snd.Source.apply(this,arguments),this.type=snd.srctype.AUDIO_BUFFER,this.status=snd.status.NONE,this.loop=!1,this.loopStart=null,this.loopEnd=null,this.listeners={onended:[]}},snd.BufferSource.prototype=Object.create(snd.Source.prototype),snd.BufferSource.prototype.constructor=snd.BufferSource,snd.BufferSource.prototype.start=function(a,b,c){null!=this.source&&this.status==snd.status.READY?(null==a?this.source.start(0):null==b?this.source.start(a):null==c?this.source.start(a,b):this.source.start(a,b,c),this.status=snd.status.STARTED):null!=this.audioBuffer&&(this.status==snd.status.STARTED?(this.stop(0),this.status=snd.status.STOPPED):this.setAudioBuffer(this.audioBuffer),this.start(a,b,c))},snd.BufferSource.prototype.stop=function(a){null!=this.source&&this.source.stop(null==a?0:a)},snd.BufferSource.prototype.connect=function(a){this.gain.connect(a.isAudioUnit?a.getConnector():a)},snd.BufferSource.prototype.disconnect=function(a){this.gain.disconnect(a)},snd.BufferSource.prototype.setLoop=function(a){null!=this.source&&(this.source.loop=a),this.loop=a},snd.BufferSource.prototype.getLoop=function(){return this.loop},snd.BufferSource.prototype.setLoopStart=function(a){null!=this.source&&null!=a&&(this.source.loopStart=a),this.loopStart=a},snd.BufferSource.prototype.getLoopStart=function(){return this.loopStart},snd.BufferSource.prototype.setLoopEnd=function(a){null!=this.source&&null!=a&&(this.source.loopEnd=a),this.loopEnd=a},snd.BufferSource.prototype.getLoopEnd=function(){return this.loopEnd},snd.BufferSource.prototype.addOnEndedEventListener=function(a){this.listeners.onended.push(a)},snd.BufferSource.prototype.removeOnEndedEventListener=function(a){for(var b=this.listeners.onended,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.BufferSource.prototype.setAudioBuffer=function(a){this.audioBuffer=a;var b=snd.AUDIO_CONTEXT.createBufferSource();null!=this.source&&this.source.disconnect(this.gain),delete this.source,this.source=b,this.source.buffer=this.audioBuffer,this.source.connect(this.gain),this.resetEventMethods(this.source),this.source.loop=this.loop,null!=this.loopStart&&(this.source.loopStart=this.loopStart),null!=this.loopEnd&&(this.source.loopEnd=this.loopEnd),this.status=snd.status.READY},snd.BufferSource.prototype.resetEventMethods=function(){var a=this;this.source.onended=function(){for(var b=a.listeners.onended,c=0;c<b.length;c++)b[c](a)}},snd.OscillatorSource=function(){snd.Source.apply(this,arguments),this.type=snd.srctype.OSCILLATOR,this.status=snd.status.NONE,this.periodicWave=null,this.listeners={onended:[]},this.resetOscillator()},snd.OscillatorSource.prototype=Object.create(snd.Source.prototype),snd.OscillatorSource.prototype.constructor=snd.OscillatorSource,snd.OscillatorSource.DEFAULT_FREQUENCY=440,snd.OscillatorSource.SINE="sine",snd.OscillatorSource.SQUARE="square",snd.OscillatorSource.SAWTOOTH="sawtooth",snd.OscillatorSource.TRIANGLE="triangle",snd.OscillatorSource.prototype.setWaveForm=function(a){a===snd.oscillatortype.SINE||a===snd.oscillatortype.SQUARE||a===snd.oscillatortype.SAWTOOTH||a===snd.oscillatortype.TRIANGLE?this.setOscillatorType(a):this.setPeriodicWave(a)},snd.OscillatorSource.prototype.setOscillatorType=function(a){null!=this.source&&(this.source.type=a)},snd.OscillatorSource.prototype.getOscillatorType=function(){return null!=this.source?this.source.type:null},snd.OscillatorSource.prototype.setFrequency=function(a){null!=this.source&&(this.source.frequency.value=a)},snd.OscillatorSource.prototype.getFrequency=function(){return null!=this.source?this.source.frequency.value:null},snd.OscillatorSource.prototype.setDetune=function(a){null!=this.source&&(this.source.detune.value=a)},snd.OscillatorSource.prototype.getDetune=function(){return null!=this.source?this.source.detune.value:null},snd.OscillatorSource.prototype.setPeriodicWave=function(a){this.periodicWave=a,null!=this.source&&this.source.setPeriodicWave(a)},snd.OscillatorSource.prototype.getPeriodicWave=function(){return this.periodicWave},snd.OscillatorSource.prototype.start=function(a){null!=this.source&&this.status!=snd.status.STARTED&&this.status!=snd.status.STOPPED&&(this.source.start(null==a?0:a),this.status=snd.status.STARTED)},snd.OscillatorSource.prototype.stop=function(a){this.status!=snd.status.STOPPED&&(this.source.stop(null==a?0:a),this.status=snd.status.STOPPED)},snd.OscillatorSource.prototype.resetOscillator=function(){var a=null,b=null,c=null;null!=this.source&&(a=this.getFrequency(),b=this.getDetune(),this.status!=snd.status.STOPPED&&this.source.stop(0),c=this.getOscillatorType()),this.source=snd.AUDIO_CONTEXT.createOscillator(),this.resetEventMethods(),this.source.connect(this.gain),this.setFrequency(null!=a?a:snd.OscillatorSource.DEFAULT_FREQUENCY),null!=b?this.setDetune(b):this.setFrequency(0),null!=c&&"custom"!=c&&this.setOscillatorType(c),null!=this.getPeriodicWave()&&this.setPeriodicWave(this.getPeriodicWave()),this.status=snd.status.READY},snd.OscillatorSource.prototype.addOnEndedEventListener=function(a){this.listeners.onended.push(a)},snd.OscillatorSource.prototype.removeOnEndedEventListener=function(a){for(var b=this.listeners.onended,c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}},snd.OscillatorSource.prototype.resetEventMethods=function(){var a=this;this.source.onended=function(){for(var b=a.listeners.onended,c=0;c<b.length;c++)b[c](a)}},snd.MediaElementAudioSource=function(a,b){snd.Source.apply(this,arguments),this.source=snd.AUDIO_CONTEXT.createMediaElementSource(b),this.source.connect(this.gain),this.type=snd.srctype.MEDIA_ELEMENT,this.element=b,this.status=snd.status.NONE,this.listeners={onplay:[],onpause:[],onended:[],onabort:[],oncanplay:[],oncanplaythrough:[],ondurationchange:[],onemptied:[],onerror:[],onloadeddata:[],onloadedmetadata:[],onloadstart:[],onplaying:[],onprogress:[],onratechange:[],onseeked:[],onseeking:[],onstalled:[],onsuspend:[],ontimeupdate:[],onvolumechange:[],onwaiting:[]};var c=this;this.element.onplay=function(){c.status=snd.status.STARTED;for(var a=0;a<c.listeners.onplay.length;a++)c.listeners.onplay[a](c)},this.element.onpause=function(){c.status=snd.status.PAUSED;for(var a=0;a<c.listeners.onpause.length;a++)c.listeners.onpause[a](c)},this.element.onended=function(){c.status=snd.status.PAUSED;for(var a=0;a<c.listeners.onended.length;a++)c.listeners.onended[a](c)},this.element.onabort=function(){for(var a=0;a<c.listeners.onabort.length;a++)c.listeners.onabort[a](c)},this.element.oncanplay=function(){c.status==snd.status.NONE&&(c.status=snd.status.READY);for(var a=0;a<c.listeners.oncanplay.length;a++)c.listeners.oncanplay[a](c)},this.element.oncanplaythrough=function(){for(var a=0;a<c.listeners.oncanplaythrough.length;a++)c.listeners.oncanplaythrough[a](c)},this.element.ondurationchange=function(){for(var a=0;a<c.listeners.ondurationchange.length;a++)c.listeners.ondurationchange[a](c)},this.element.onemptied=function(){for(var a=0;a<c.listeners.onemptied.length;a++)c.listeners.onemptied[a](c)},this.element.onerror=function(){for(var a=0;a<c.listeners.onerror.length;a++)c.listeners.onerror[a](c)},this.element.onloadeddata=function(){for(var a=0;a<c.listeners.onloadeddata.length;a++)c.listeners.onloadeddata[a](c)},this.element.onloadedmetadata=function(){for(var a=0;a<c.listeners.onloadedmetadata.length;a++)c.listeners.onloadedmetadata[a](c)},this.element.onloadedstart=function(){for(var a=0;a<c.listeners.onloadstart.length;a++)c.listeners.onloadstart[a](c)},this.element.onplaying=function(){for(var a=0;a<c.listeners.onplaying.length;a++)c.listeners.onplaying[a](c)},this.element.onprogress=function(){for(var a=0;a<c.listeners.onprogress.length;a++)c.listeners.onprogress[a](c)},this.element.onratechange=function(){for(var a=0;a<c.listeners.onratechange.length;a++)c.listeners.onratechange[a](c)},this.element.onseeked=function(){for(var a=0;a<c.listeners.onseeked.length;a++)c.listeners.onseeked[a](c)},this.element.onseeking=function(){for(var a=0;a<c.listeners.onseeking.length;a++)c.listeners.onseeking[a](c)},this.element.onstalled=function(){for(var a=0;a<c.listeners.onstalled.length;a++)c.listeners.onstalled[a](c)},this.element.onsuspend=function(){for(var a=0;a<c.listeners.onsuspend.length;a++)c.listeners.onsuspend[a](c)},this.element.ontimeupdate=function(){for(var a=0;a<c.listeners.ontimeupdate.length;a++)c.listeners.ontimeupdate[a](c)},this.element.onvolumechange=function(){for(var a=0;a<c.listeners.onvolumechange.length;a++)c.listeners.onvolumechange[a](c)},this.element.onwaiting=function(){for(var a=0;a<c.listeners.onwaiting.length;a++)c.listeners.onwaiting[a](c)},Object.defineProperties(this,{src:{enumerable:!0,get:function(){return this.element.src},set:function(a){this.element.src=a}}})},snd.MediaElementAudioSource.prototype=Object.create(snd.Source.prototype),snd.MediaElementAudioSource.prototype.constructor=snd.MediaElementAudioSource,snd.MediaElementAudioSource.prototype.load=function(){this.element.load()},snd.MediaElementAudioSource.prototype.start=function(){this.element.play()},snd.MediaElementAudioSource.prototype.pause=function(){this.element.pause()},snd.MediaElementAudioSource.prototype.stop=function(){this.element.pause(),this.element.currentTime=0},snd.MediaElementAudioSource.prototype.setLoop=function(a){this.element.loop=a},snd.MediaElementAudioSource.prototype.addOnPlayEventListener=function(a){this.listeners.onplay.push(a)},snd.MediaElementAudioSource.prototype.removeOnPlayEventListener=function(a){for(var b=this.listeners.onplay,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnPauseEventListener=function(a){this.listeners.onPause.push(a)},snd.MediaElementAudioSource.prototype.removeOnPauseEventListener=function(a){for(var b=this.listeners.onPause,c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}},snd.MediaElementAudioSource.prototype.addOnEndedEventListener=function(a){this.listeners.onended.push(a)},snd.MediaElementAudioSource.prototype.removeOnEndedEventListener=function(a){for(var b=this.listeners.onended,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnAbortEventListener=function(a){this.listeners.onabort.push(a)},snd.MediaElementAudioSource.prototype.removeOnAbortEventListener=function(a){for(var b=this.listeners.onabort,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnCanPlayEventListener=function(a){this.listeners.oncanplay.push(a)},snd.MediaElementAudioSource.prototype.removeOnCanPlayEventListener=function(a){for(var b=this.listeners.oncanplay,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnCanPlayThroughEventListener=function(a){this.listeners.oncanplaythrough.push(a)},snd.MediaElementAudioSource.prototype.removeOnCanPlayThroughEventListener=function(a){for(var b=this.listeners.onplaythrough,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnDurationChangeEventListener=function(a){this.listeners.ondurationchange.push(a)},snd.MediaElementAudioSource.prototype.removeOnCanPlayThroughEventListener=function(a){for(var b=this.listeners.ondurationchange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnEmptiedEventListener=function(a){this.listeners.onemptied.push(a)},snd.MediaElementAudioSource.prototype.removeOnEmptiedEventListener=function(a){for(var b=this.listeners.onemptied,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnErrorEventListener=function(a){this.listeners.onerror.push(a)},snd.MediaElementAudioSource.prototype.removeOnErrorEventListener=function(a){for(var b=this.listeners.onerror,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnLoadedDataEventListener=function(a){this.listeners.onloadeddata.push(a)},snd.MediaElementAudioSource.prototype.removeOnLoadedDataEventListener=function(a){for(var b=this.listeners.onloadeddata,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnLoadedMetadataEventListener=function(a){this.listeners.onloadedmetadata.push(a)},snd.MediaElementAudioSource.prototype.removeOnLoadedMetaDataEventListener=function(a){for(var b=this.listeners.onloadedmetadata,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnLoadStartEventListener=function(a){this.listeners.onloadstart.push(a)},snd.MediaElementAudioSource.prototype.removeOnLoadStartEventListener=function(a){for(var b=this.listeners.onloadstart,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnPlayingEventListener=function(a){this.listeners.onPlaying.push(a)},snd.MediaElementAudioSource.prototype.removeOnPlayingEventListener=function(a){for(var b=this.listeners.onPlaying,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnProgressEventListener=function(a){this.listeners.onprogress.push(a)},snd.MediaElementAudioSource.prototype.removeOnProgressEventListener=function(a){for(var b=this.listeners.onprogress,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnRateChangeEventListener=function(a){this.listeners.onratechange.push(a)},snd.MediaElementAudioSource.prototype.removeOnRateChangeEventListener=function(a){for(var b=this.listeners.onratechange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnSeekedEventListener=function(a){this.listeners.onseeked.push(a)},snd.MediaElementAudioSource.prototype.removeOnSeekedEventListener=function(a){for(var b=this.listeners.onseeked,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnSeekingEventListener=function(a){this.listeners.onseeking.push(a)},snd.MediaElementAudioSource.prototype.removeOnSeekingEventListener=function(a){for(var b=this.listeners.onseeking,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnStalledEventListener=function(a){this.listeners.onstalled.push(a)},snd.MediaElementAudioSource.prototype.removeOnStalledEventListener=function(a){for(var b=this.listeners.onstalled,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnSuspendEventListener=function(a){this.listeners.onsuspend.push(a)},snd.MediaElementAudioSource.prototype.removeOnSuspendEventListener=function(a){for(var b=this.listeners.onsuspend,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnTimeUpdateEventListener=function(a){this.listeners.ontimeupdate.push(a)},snd.MediaElementAudioSource.prototype.removeOnTimeUpdateEventListener=function(a){for(var b=this.listeners.ontimeupdate,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnVolumeChangeEventListener=function(a){this.listeners.onvolumechange.push(a)},snd.MediaElementAudioSource.prototype.removeOnVolumeChangeEventListener=function(a){for(var b=this.listeners.onvolumechange,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaElementAudioSource.prototype.addOnWaitingEventListener=function(a){this.listeners.onwaiting.push(a)},snd.MediaElementAudioSource.prototype.removeOnWaitingEventListener=function(a){for(var b=this.listeners.onwaiting,c=0;c<b.length;c++)if(b[c]===a)return b.splice(c,1),!0;return!1},snd.MediaStreamAudioSource=function(a,b){snd.Source.apply(this,arguments),this.source=snd.AUDIO_CONTEXT.createMediaStreamAudioSource(b),this.source.connect(this.gain),this.type=snd.srctype.MEDIA_STREAM},snd.MediaStreamAudioSource.prototype=Object.create(snd.Source.prototype),snd.MediaStreamAudioSource.prototype.constructor=snd.MediaStreamAudioSource,snd.Synth=function(a,b,c){snd.Source.apply(this,arguments),this.polyphony=b,this._settings=c,this.partes=[];for(var d=0;d<this.polyphony;d++){var e=new snd.Synth.Partes(this.id+d,this._settings);e.connect(this.gain),this.partes.push(e)}Object.defineProperty(this,"settings",{configurable:!0,enumerable:!0,get:function(){return this._settings},set:function(a){this.settings=a;for(var b=0;b<this.polyphony;b++)this.partes[b].settings=this.settings}})},snd.Synth.prototype=Object.create(snd.Source.prototype),snd.Synth.prototype.constructor=snd.Synth,snd.Synth.setWaveForm=function(a){if(this.settings.waveform=a,a===snd.oscillatortype.SINE||a===snd.oscillatortype.SQUARE||a===snd.oscillatortype.SAWTOOTH||a===snd.oscillatortype.TRIANGLE)for(i=0;i<this.partes.length;i++)this.partes[i].setOscillatorType(a);else for(i=0;i<this.partes.length;i++)this.partes[i].setPeriodicWave(a)},snd.Synth.prototype.noteOn=function(a){for(var b=0;b<a.length;b++){var c=a[b].no,d=a[b].freq;this.partes[c].noteOn(d)}},snd.Synth.prototype.noteOff=function(a){for(var b=0;b<a.length;b++){var c=a[b].no;this.partes[c].noteOff()}},snd.Synth.Partes=function(a,b){snd.OscillatorSource.apply(this,arguments);var c=this;this.setGain(0),this.settings=b,this.settings.onchange=function(){c.setWaveType(c.settings.waveform)},this.ampEnvelope=new snd.Envelope(this.gain.gain,this.settings.amplitude.envelope),this.ampLFO=new snd.Synth.LFO(this.id+"_AmpLFO",this.gain.gain,this.settings.amplitude.lfo),this.freqEnvelope=new snd.Envelope(this.source.frequency,this.settings.frequency.envelope),this.freqLFO=new snd.Synth.LFO(this.id+"_FreqLFO",this.source.frequency,this.settings.frequency.lfo)},snd.Synth.Partes.prototype=Object.create(snd.OscillatorSource.prototype),snd.Synth.Partes.prototype.constructor=snd.Synth.Note,snd.Synth.Partes.prototype.noteOn=function(a){this.freqEnvelope.settings.max=a,this.start(0),this.ampEnvelope.noteOn(),this.ampLFO.noteOn(),this.freqEnvelope.noteOn(),this.freqLFO.noteOn()},snd.Synth.Partes.prototype.noteOff=function(){this.ampEnvelope.noteOff(),this.ampLFO.noteOff(),this.freqEnvelope.noteOff(),this.freqLFO.noteOff()},snd.Synth.LFO=function(a,b,c){snd.OscillatorSource.apply(this,arguments);var d=this;this.baseValue=0,this.param=b,this.gain.connect(this.param),this._settings=c,this.freqEnvelope=new snd.Envelope(this.source.frequency,c.frequency),this.ampEnvelope=new snd.Envelope(this.gain.gain,c.amplitude),this._settings.onchange=function(){d.source.setWaveForm(d.settings.waveform)},Object.defineProperty(this,"settings",{configurable:!0,enumerable:!0,get:function(){return this._settings},set:function(a){this._settings=a,this.setWaveForm(a.waveform),this.freqEnvelope.settings=a.frequency,this.ampEnvelope.settings=a.amplitude}})},snd.Synth.LFO.prototype=Object.create(snd.OscillatorSource.prototype),snd.Synth.LFO.prototype.constructor=snd.Synth.LFO,snd.Synth.LFO.prototype.noteOn=function(){this.start(0),this.ampEnvelope.noteOn(),this.freqEnvelope.noteOn()},snd.Synth.LFO.prototype.noteOff=function(){this.ampEnvelope.noteOff(),this.freqEnvelope.noteOff()},snd.Envelope=function(a,b){this.param=a,this.settings=b},snd.Envelope.prototype.noteOn=function(){var a=snd.AUDIO_CONTEXT.currentTime;if(this.param.cancelScheduledValues(a),this.param.value=0,this.settings.attackTime>=0)switch(this.settings.attackType){case snd.audioparam.type.LINER:this.param.linearRampToValueAtTime(this.settings.attack*this.settings.max,a+this.settings.attackTime);break;case snd.audioparam.type.EXPONENTIALLY:this.param.exponentialRampToValueAtTime(this.settings.attack*this.settings.max,a+this.settings.attackTime);break;default:this.param.setValueAtTime(this.settings.attack*this.settings.max,a+this.settings.attackTime)}if(this.settings.decayTime>0)switch(this.settings.decayType){case snd.audioparam.type.LINER:this.param.linearRampToValueAtTime(this.settings.sustain*this.settings.max,a+this.settings.attackTime+this.settings.decayTime);break;case snd.audioparam.type.EXPONENTIALLY:this.param.exponentialRampToValueAtTime(this.settings.sustain*this.settings.max,a+this.settings.attackTime+this.settings.decayTime);break;default:this.param.setValueAtTime(this.settings.sustain*this.settings.max,a+this.settings.attackTime+this.settings.decayTime)}if(this.settings.sustainTime>0){switch(this.settings.sustainType){case snd.audioparam.type.LINER:this.param.linearRampToValueAtTime(this.settings.release*this.settings.max,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime);break;case snd.audioparam.type.EXPONENTIALLY:this.param.exponentialRampToValueAtTime(this.settings.release*this.settings.max,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime);break;default:this.param.setValueAtTime(this.settings.release*this.settings.max,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime)}switch(this.settings.releaseType){case snd.audioparam.type.LINER:this.param.linearRampToValueAtTime(0,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime+this.settings.releaseTime);break;case snd.audioparam.type.EXPONENTIALLY:this.param.exponentialRampToValueAtTime(0,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime+this.settings.releaseTime);break;default:this.param.setValueAtTime(0,a+this.settings.attackTime+this.settings.decayTime+this.settings.sustainTime+this.settings.releaseTime)}}},snd.Envelope.prototype.noteOff=function(){var a=snd.AUDIO_CONTEXT.currentTime;switch(this.param.cancelScheduledValues(a),this.settings.releaseType){case snd.audioparam.type.LINER:this.param.linearRampToValueAtTime(0,a+this.settings.releaseTime);break;case snd.audioparam.type.EXPONENTIALLY:this.param.exponentialRampToValueAtTime(0,a+this.settings.releaseTime);break;default:this.param.setValueAtTime(0,a+this.settings.releaseTime)}},snd.Synth.Settings=function(){this._waveform="sine",this.frequency={envelope:new snd.Synth.Settings.EnvelopeSettings(440,0,1,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER),lfo:new snd.Synth.Settings.LFOSettings("sine",new snd.Synth.Settings.EnvelopeSettings(0,0,0,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER),new snd.Synth.Settings.EnvelopeSettings(0,0,0,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER))},this.amplitude={envelope:new snd.Synth.Settings.EnvelopeSettings(.2,0,1,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER),lfo:new snd.Synth.Settings.LFOSettings("sine",new snd.Synth.Settings.EnvelopeSettings(0,0,1,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER),new snd.Synth.Settings.EnvelopeSettings(0,0,1,snd.audioparam.LINER,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER,0,0,snd.audioparam.LINER))},Object.defineProperty(this,"waveform",{configurable:!0,enumerable:!0,gat:function(){return this._waveform},set:function(a){this._wavefrom=a,this.onchange()}})},snd.Synth.Settings.prototype.onchange=function(){},snd.Synth.Settings.LFOSettings=function(a,b,c){this._waveform=a,this.frequency=b,this.amplitude=c,Object.defineProperty(this,"waveform",{configurable:!0,enumerable:!0,get:function(){return this._waveform},set:function(a){this._waveform=a,this.onchange()}})},snd.Synth.Settings.LFOSettings.prototype.onchange=function(){},snd.Synth.Settings.EnvelopeSettings=function(a,b,c,d,e,f,g,h,i,j,k,l){this._max=a,this._attackTime=b,this._attack=c,this._attackType=d,this._decayTime=e,this._decayType=f,this._sustainTime=g,this._sustain=h,this._sustainType=i,this._releaseTime=j,this._release=k,this._releaseType=l,Object.defineProperties(this,{max:{configurable:!0,enumerable:!0,get:function(){return this._max},set:function(a){this._max=a,this.onchange()}},attackTime:{configurable:!0,enumerable:!0,get:function(){return this._attackTime},set:function(a){this._attackTime=a,this.onchange()}},attack:{configurable:!0,enumerable:!0,get:function(){return this._attack},set:function(a){this._attack=a,this.onchange()}},attackType:{configurable:!0,enumerable:!0,get:function(){return this._attackType},set:function(a){this._attackType=a,this.onchange()}},decayTime:{configurable:!0,enumerable:!0,get:function(){return this._decayTime},set:function(a){this._decayTime=a,this.onchange()}},decayType:{configurable:!0,enumerable:!0,get:function(){return this._decayType},set:function(a){this._decayType=a,this.onchange()}},sustainTime:{configurable:!0,enumerable:!0,get:function(){return this._sustainTime},set:function(a){this._sustainTime=a,this.onchange()}},sustain:{configurable:!0,enumerable:!0,get:function(){return this._sustain},set:function(a){this._sustain=a,this.onchange()}},sustainType:{configurable:!0,enumerable:!0,get:function(){return this._sustainType},set:function(a){this._sustainType=a,this.onchange()}},releaseTime:{configurable:!0,enumerable:!0,get:function(){return this._releaseTime},set:function(a){this._releaseTime=a,this.onchange()}},release:{configurable:!0,enumerable:!0,get:function(){return this._release},set:function(a){this._release=a,this.onchange()}},releaseType:{configurable:!0,enumerable:!0,get:function(){return this._releaseType},set:function(a){this._releaseType=a,this.onchange()}}})},snd.Synth.Settings.EnvelopeSettings.prototype.onchange=function(){},snd.AudioUnit=function(a){this.isAudioUnit=!0,this.id=a},snd.AudioUnit.prototype.connect=function(){},snd.AudioUnit.prototype.disconnect=function(){},snd.AudioUnit.prototype.getConnector=function(){},snd.GainOnlyUnit=function(){snd.AudioUnit.apply(this,arguments),this.gain=snd.AUDIO_CONTEXT.createGain()},snd.GainOnlyUnit.prototype=Object.create(snd.AudioUnit.prototype),snd.GainOnlyUnit.prototype.constructor=snd.GainOnlyUnit,snd.GainOnlyUnit.prototype.connect=function(a){this.gain.connect(a.isAudioUnit?a.getConnector():a)},snd.GainOnlyUnit.prototype.disconnect=function(a){a.isAudioUnit?this.gain.disconnect(a.getConnector()):this.gain.disconnet(a)},snd.GainOnlyUnit.prototype.getConnector=function(){return this.gain},snd.GainOnlyUnit.prototype.getGain=function(){return this.gain},snd.AudioDataManager=function(){this.requests={},this.dataMap={},this.eventListeners={},this.allLoadEventListeners=[]},snd.AudioDataManager.prototype.onload=function(){for(var a=0;a<this.allLoadEventListeners.length;a++)this.allLoadEventListeners[a]()},snd.AudioDataManager.prototype.addAllDataLoadListener=function(a){this.allLoadEventListeners.push(a)},snd.AudioDataManager.prototype.removeAllDataLoadListener=function(a){for(var b=0;b<this.allLoadEventListeners.length;b++){var c=this.allLoadEventListeners[b];if(c===a)return delete this.allLoadEventListeners[b],!0}return!1},snd.AudioDataManager.prototype.addOnloadListener=function(a,b){null==this.eventListeners.onload[a]&&(this.eventListeners[a]=[]),this.eventListeners.onload[a].push(b)},snd.AudioDataManager.prototype.removeOnloadListener=function(a){return null!=this.eventListeners.onload[a]?(delete this.eventListeners.onload[a],!0):!1},snd.AudioDataManager.prototype.getAudioBuffer=function(a){return null!=this.dataMap[a]?this.dataMap[a].data:void 0},snd.AudioDataManager.prototype.add=function(a,b){var c=this;this.dataMap[a]={doesLoaded:!1};var d=new XMLHttpRequest;d.open("GET",b,!0),d.responseType="arraybuffer",d.onload=function(){snd.AUDIO_CONTEXT.decodeAudioData(d.response,function(b){c.dataMap[a].data=b,c.dataMap[a].doesLoaded=!0,c.loaded(a,b)})},this.requests[a]=d},snd.AudioDataManager.prototype.doesAllDataLoaded=function(){for(var a in this.dataMap)if(!this.dataMap[a].doesLoaded)return!1;return!0},snd.AudioDataManager.prototype.addAll=function(a){for(var b in a)this.add(b,a[b])},snd.AudioDataManager.prototype.load=function(a){if(null==a)for(var a in this.requests)this.requests[a].send();else this.requests[a].send()},snd.AudioDataManager.prototype.loaded=function(a,b){if(this.dataMap[a].doesLoaded=!0,null!=this.eventListeners[a])for(var c=0;c<this.eventListeners[a].onload.length;c++)this.eventListeners[a].onload[c](b);for(var d in this.dataMap)if(!this.dataMap[d].doesLoaded)return;this.onload()},snd.AudioMaster=function(){this.unitList={},this.gain=snd.AUDIO_CONTEXT.createGain(),this.gain.connect(snd.AUDIO_CONTEXT.destination)},snd.AudioMaster.prototype.connectAudioUnit=function(a,b){if(null==a&&null==b.id)throw"key == null && audioUnit.id == null";
null==a?null==this.unitList[b.id]&&(this.unitList[b.id]=b,b.connect(this.gain)):(this.unitList[a]=b,b.connect(this.gain))},snd.AudioMaster.prototype.getAudioUnit=function(a){return this.unitList[a]},snd.AudioMaster.prototype.disconnectAudioUnit=function(a){var b=this.unitList[a];b.getConnector().disconnect(this.gain),delete this.unitList[a]},snd.util={},snd.util.createSources=function(a,b,c,d){var e={};e.MediaElement=null!=a.MediaElement?snd.util.createMediaElementAudioSources(a.MediaElement,b,c):null,null!=a.AudioBuffer?createBufferSources(a.AudioBuffer,b,function(a){e.AudioBuffer=a,d(e)}):(e.AudioBuffer=null,d(e))},snd.util.createBufferSources=function(a,b,c){var d={},e={};for(var f in a){var g=a[f];null==d[g]&&(d[g]=[]);var h=new snd.BufferSource(f);d[g].push(h)}for(var g in d)e[g]=g;snd.AUDIO_DATA_MANAGER.addAll(e),snd.AUDIO_DATA_MANAGER.addAllDataLoadListener(function(){var a={};for(var e in d){for(var f=0;f<d[e].length;f++)d[e][f].setAudioBuffer(snd.AUDIO_DATA_MANAGER.getAudioBuffer(e)),a[d[e][f].id]=d[e][f];b&&snd.MASTER.connectAudioUnit(d[e][f].id,d[e][f])}c(a)}),snd.AUDIO_DATA_MANAGER.load()},snd.util.createMediaElementAudioSources=function(a,b,c){var d={};for(var e in a){var f,g=document.getElementById(e);null==g?(f=new Audio(e),c.appendChild(f)):f=g,null!=a[e]&&""!=a[e]&&(f.src=a[e]);var h=new snd.MediaElementAudioSource(e,f);d[e]=h,b&&snd.MASTER.connectAudioUnit(e,h)}return d},snd.util.noteToFrequency=function(a,b){return 440*Math.pow(2,(12*(a-4)+b-9)/12)},snd.util.noteToSec=function(a,b){return 60/(a*b/4)},snd.AUDIO_CONTEXT=null,snd.MASTER=null,snd.AUDIO_DATA_MANAGER=null,snd.init=function(){snd.resetAudioContext(),null!=snd.SoundEnvironment&&(snd.SOUND_ENVIRONMENT=new snd.SoundEnvironment),snd.MASTER=new snd.AudioMaster,snd.AUDIO_DATA_MANAGER=new snd.AudioDataManager},snd.resetAudioContext=function(){null==snd.AUDIO_CONTEXT&&("AudioContext"in window?snd.AUDIO_CONTEXT=new AudioContext:"webkitAudioContext"in window&&(snd.AUDIO_CONTEXT=new webkitAudioContext))};